API仕様書 – Stilya（MVP）
概要
バックエンド：Supabase（PostgreSQL + Edge Functions）

認証：Supabase Auth（JWTベース）

認可：ロールベース制御（authenticated）

通信方式：HTTPS（REST API + RPC + Realtime optional）

1. 認証系 API
POST /auth/signup
内容	ユーザー新規登録（メール＋パスワード）
リクエストBody	{ email: string, password: string }
レスポンス	201 Created or エラーコード
備考	Supabase Auth 使用

POST /auth/signin
内容	ログイン処理
リクエストBody	{ email: string, password: string }
レスポンス	{ access_token, user }
備考	JWT トークンを SecureStorage に保持

2. ユーザー情報 API
GET /user/profile
内容	ユーザープロファイル取得
認証	必須（Bearerトークン）
レスポンス	{ id, email, created_at }
備考	必要に応じてユーザー嗜好も追加予定

3. 商品関連 API
GET /products
内容	商品リスト取得
パラメータ	?limit=20&offset=0
フィルタ（任意）	category, gender, tag, keyword
レスポンス	[{ id, name, image_url, price, brand, tags[] }]
備考	Supabase products テーブル

GET /products/:id
内容	商品詳細取得
レスポンス	{ id, name, description, price, brand, tags[], affiliate_url }

4. スワイプ履歴 API
POST /swipes
内容	スワイプ結果の記録
認証	必須
Body	`{ product_id: string, result: 'yes'
レスポンス	201 Created or エラー
保存先	Supabase swipes テーブル（user_idはJWTから）

GET /swipes
内容	スワイプ履歴取得
レスポンス	[{ product_id, result, timestamp }]
備考	yesのみフィルタ可能（?result=yes）

5. 推薦エンジン（MVP）
GET /recommendations
内容	パーソナライズ推薦商品リスト
認証	必須
レスポンス	[{ id, name, image_url, price, tags }]
ロジック	過去のyesスワイプのタグに類似する商品を抽出
拡張予定	CLIP画像ベース推薦、学習済モデルAPI化など

6. アフィリエイト遷移ログ
POST /click
内容	商品クリックログ記録（任意）
Body	{ product_id: string }
保存先	Supabase click_logs テーブル
備考	CVR・CTR分析のための補助ログ記録用

ER図ベースのテーブル構造（抜粋）
plaintext
コピーする
編集する
users
└── id (PK)
    email
    created_at

products
└── id (PK)
    name
    price
    image_url
    brand
    category
    tags[]
    affiliate_url

swipes
└── id (PK)
    user_id (FK)
    product_id (FK)
    result (yes/no)
    created_at

click_logs
└── id (PK)
    user_id (FK)
    product_id (FK)
    created_at
備考
セキュリティはSupabase Row Level Security（RLS）を活用

APIは supabase-js SDK で直接操作される想定

Edge Function により外部API処理（例：LinkShare 商品取得）も対応可能