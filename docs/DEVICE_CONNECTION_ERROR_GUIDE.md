# 実機接続エラー解決ガイド

## 🔴 現在のエラー
```
Could not connect to development server.
URL: http://192.168.0.214:8081/...
```

## 🚀 解決方法（推奨順）

### 方法1: トンネルモードで起動（最も簡単）
```bash
# 作成したスクリプトを実行
./start-tunnel.sh

# または直接実行
npx expo start --tunnel
```

**メリット**:
- ファイアウォールの問題を回避
- 同じWiFiネットワークでなくても動作
- QRコードをスキャンするだけで接続

### 方法2: ネットワーク設定の確認
1. **開発マシンと実機が同じWiFiに接続されているか確認**
   ```bash
   # 開発マシンのIPアドレスを確認
   ifconfig | grep "inet " | grep -v 127.0.0.1
   ```

2. **ファイアウォールの設定を確認**
   - macOSの「システム環境設定」→「セキュリティとプライバシー」→「ファイアウォール」
   - ファイアウォールが有効な場合、「ファイアウォールオプション」で着信接続を許可

3. **ポート8081が開いているか確認**
   ```bash
   # 別のターミナルで実行
   nc -zv localhost 8081
   ```

### 方法3: 異なるポートで起動
```bash
# ポート8082で起動
npx expo start --port 8082 --clear
```

### 方法4: LANモードで明示的に起動
```bash
# LANモードを強制
npx expo start --lan --clear
```

### 方法5: 実機のExpo Goアプリをリセット
1. Expo Goアプリを完全に終了（アプリスイッチャーから削除）
2. 実機を再起動
3. Expo Goを再度開く

## 🛠 デバッグ手順

### 1. 現在のネットワーク状態を確認
```bash
# 開発マシンで実行
echo "=== ネットワーク情報 ==="
ifconfig | grep "inet " | grep -v 127.0.0.1
echo ""
echo "=== 実行中のExpoプロセス ==="
ps aux | grep expo
echo ""
echo "=== ポート8081の状態 ==="
netstat -an | grep 8081
```

### 2. Expoの設定をリセット
```bash
# Expoの設定を完全にリセット
rm -rf ~/.expo
rm -rf .expo
npx expo doctor
```

### 3. Node.jsとnpmのキャッシュをクリア
```bash
npm cache clean --force
```

## 📱 代替案: EASビルドで実機テスト

ローカル接続が難しい場合は、EASビルドでプレビュー版を作成：

```bash
# プレビュービルドを作成
eas build --platform ios --profile preview

# ビルド完了後、QRコードからインストール
```

## ✅ 推奨される即時対応

1. **まず試す**: `./start-tunnel.sh` を実行
2. **それでもダメなら**: EASビルドでプレビュー版を作成
3. **並行して**: ネットワーク設定を確認

## 🔍 よくある原因

- **VPNが有効**: VPNを無効にしてみる
- **企業ネットワーク**: ポート制限がある可能性
- **セキュリティソフト**: 一時的に無効化してテスト
- **IPアドレスの変更**: WiFi再接続でIPが変わった

## 💡 Tips

- トンネルモードは若干遅いが、接続問題を回避できる
- 実機テストが難しい場合は、シミュレーターで開発を進める
- MVP完成を優先し、接続問題に時間をかけすぎない