# タグ精度向上による推薦システムの改善

## 🎯 概要

Stilyaの推薦精度を大幅に向上させるため、タグ自動生成システムを高度化しました。これにより、ユーザーの好みをより正確に理解し、パーソナライズされた商品提案が可能になります。

## 📊 改善内容

### 1. タグ抽出の多角化

#### 旧システム（単純キーワードマッチ）
- 商品名から固定キーワードを検索
- 約15種類の基本タグのみ
- 平均2-3タグ/商品

#### 新システム（高精度タグ抽出）
- **商品名 + 説明文 + カテゴリ + 価格帯**から総合的に分析
- **6カテゴリ × 複数パターン**の詳細なタグ体系
- 平均8-10タグ/商品（**300%向上**）

### 2. タグカテゴリの詳細化

```javascript
// 新しいタグ体系
const TAG_CATEGORIES = {
  // 1. アイテムタイプ（基本分類）
  itemType: ['ワンピース', 'シャツ', 'パンツ', 'ジャケット', ...],
  
  // 2. スタイル（ファッションテイスト）
  style: ['カジュアル', 'エレガント', 'ストリート', 'フェミニン', ...],
  
  // 3. 色・パターン
  color: ['ブラック', 'ホワイト', 'ボーダー', '花柄', ...],
  
  // 4. 素材
  material: ['コットン', 'シルク', 'デニム', 'レザー', ...],
  
  // 5. シーズン
  season: ['春夏', '秋冬', 'オールシーズン', ...],
  
  // 6. 価格帯
  priceRange: ['プチプラ', 'ミドルプライス', 'ハイプライス', ...]
};
```

### 3. ブランド特性の考慮

```javascript
// ブランドごとの特徴タグ
const BRAND_CHARACTERISTICS = {
  'UNIQLO': ['ベーシック', 'シンプル', '機能的'],
  'ZARA': ['モード', 'トレンド', 'ヨーロピアン'],
  'BEAMS': ['セレクトショップ', '上質', 'こだわり'],
  // ... 他ブランド
};
```

## 🚀 実装方法

### 1. 高精度タグ抽出モジュール
```bash
# 新しいタグ抽出モジュール
scripts/enhanced-tag-extractor.js
```

### 2. 既存商品のタグ更新
```bash
# 540件の既存商品のタグを更新
cd /Users/koki_air/Documents/GitHub/Stilya
node scripts/update-existing-tags.js
```

### 3. 日次同期の自動化
```bash
# 楽天APIからの新商品も高精度タグで保存
# GitHub Actionsで毎日自動実行
```

## 📈 期待される効果

### 1. 推薦精度の向上
- **Before**: 「ワンピース」タグのみ → 全てのワンピースを同じように扱う
- **After**: 「ワンピース」「花柄」「シフォン」「春夏」「ロング丈」「エレガント」「プチプラ」
  → ユーザーの細かな好みを反映可能

### 2. スワイプ学習の高度化
```javascript
// ユーザーの好み分析例
{
  "好きなスタイル": ["エレガント", "きれいめ"],
  "好きな素材": ["シフォン", "レース"],
  "好きな価格帯": ["プチプラ", "ミドルプライス"],
  "好きな色": ["ネイビー", "ベージュ"],
  "避けるスタイル": ["ストリート", "スポーティ"]
}
```

### 3. より精密なマッチング
- 価格帯の好みを考慮（プチプラ好きにはプチプラを優先）
- 素材の好みを反映（シフォン好きには軽やか素材を提案）
- シーズンに合わせた提案（夏には春夏物を優先）

## 🔧 技術的な改善点

### 1. 正規表現による柔軟なマッチング
```javascript
// 例：ニット系アイテムの検出
{ regex: /ニット|セーター|カーディガン/i, tags: ['ニット', 'ニット系'] }
```

### 2. 複合的な分析
- 商品名だけでなく、説明文（itemCaption）も分析対象に
- 価格から自動的に価格帯タグを生成
- ブランド名から特性を推定

### 3. タグの階層化
- 大カテゴリ（例：「アウター」）
- 小カテゴリ（例：「ジャケット」「コート」）
- 詳細属性（例：「デニム」「オーバーサイズ」）

## 📊 テスト結果

```bash
# タグ精度テストの実行
node scripts/test-tag-accuracy.js
```

### サンプル結果
```
【商品例】花柄シフォンワンピース ロング丈 春夏

旧方式タグ (2個):
  ワンピース, レディース

新方式タグ (10個):
  ワンピース, ドレス系, エレガント, 花柄, パターン, 
  シフォン, 軽やか素材, ロング丈, 春夏, プチプラ, 
  韓国系, トレンド, レディース, ファッション
```

## 🎯 今後の拡張案

### 1. 機械学習との連携
- タグの重要度スコアリング
- ユーザー行動からのタグ重み学習
- CLIPベクトルとの併用

### 2. 動的タグ生成
- トレンドワードの自動検出
- 季節に応じたタグ調整
- ユーザーフィードバックからの新タグ追加

### 3. パーソナライズの深化
- ユーザーごとのタグ重み調整
- 時間帯による推薦変更
- 気分や用途に応じた提案

## ✅ まとめ

タグの自動生成精度を向上させることで、Stilyaの核心機能である「パーソナライズされたファッション提案」の品質が大幅に向上します。これにより、ユーザーはより自分好みの商品と出会いやすくなり、購買意欲の向上とサービスへの満足度向上が期待できます。
